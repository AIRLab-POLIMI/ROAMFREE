(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     51884,       1526]
NotebookOptionsPosition[     47872,       1425]
NotebookOutlinePosition[     48235,       1441]
CellTagsIndexPosition[     48192,       1438]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5729531523367567`*^9, 
  3.572953173705782*^9}},ExpressionUUID->"d2ae0e34-0aee-4398-84a7-\
83fdb362b1c0"],

Cell[CellGroupData[{

Cell["Quaternion Functions", "Subtitle",
 InitializationCell->True,
 CellChangeTimes->{{3.563606408899285*^9, 3.563606413402224*^9}, {
  3.572951250149337*^9, 
  3.572951255936389*^9}},ExpressionUUID->"a36a670e-ae9b-49f1-b10c-\
dbccef0a632e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QuatToRot", "[", "q_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}], ",", 
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}], ",", 
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"q", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"q", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}]}], "}"}]}], 
   "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.563605527886624*^9, 3.563605567626183*^9}, {
   3.563605650309675*^9, 3.563605656523316*^9}, {3.563605736240014*^9, 
   3.563605737233779*^9}, {3.563606059918521*^9, 3.563606126862539*^9}, 
   3.563608252893046*^9},ExpressionUUID->"3b9fbfee-912a-4aa4-a2f2-\
7c73891f3bc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QuatProd", "[", 
   RowBox[{"q1_", ",", "q2_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"q1", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "*", 
      RowBox[{"q2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.563606135987117*^9, 3.563606142802078*^9}, {
   3.563606201087932*^9, 3.563606209804597*^9}, 
   3.563608256344269*^9},ExpressionUUID->"7da7a48b-0a5f-4ec4-a1d3-\
d9a2d8334180"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QuadProdMatrix", "[", "q_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"q", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"q", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"q", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"q", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"q", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"q", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.572071361594997*^9, 3.572071456943955*^9}, {
  3.572071577887109*^9, 
  3.572071610308419*^9}},ExpressionUUID->"c27111b3-50a3-4eb0-bd3f-\
367c5ebdb657"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QuatInv", "[", "q_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"-", 
     RowBox[{"q", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"-", 
     RowBox[{"q", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", 
    RowBox[{"-", 
     RowBox[{"q", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.563606254567001*^9, 3.563606259724602*^9}, 
   3.563606354304121*^9, {3.563606866649937*^9, 3.563606870300694*^9}, {
   3.56360707017181*^9, 3.563607071630042*^9}, 
   3.563608250575097*^9},ExpressionUUID->"8ff927d0-78c6-4922-9aa0-\
571bb554bdf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VectProdMatrix", "[", "v_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"v", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.563607037606062*^9, 3.563607124416689*^9}, 
   3.563608231083735*^9},ExpressionUUID->"f2b631c2-1610-446a-ad5b-\
c94cdb78364d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QuatNorm", "[", "q_", "]"}], ":=", 
  RowBox[{"q", "/", 
   RowBox[{"(", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}], "]"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuatInc", "[", 
   RowBox[{"q_", ",", "dq_"}], "]"}], ":=", 
  RowBox[{"QuatProd", "[", 
   RowBox[{"q", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"dq", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "-", 
        RowBox[{
         RowBox[{"dq", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "-", 
        RowBox[{
         RowBox[{"dq", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], "]"}], ",", 
      RowBox[{"dq", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"dq", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"dq", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.564302789101026*^9, 3.564302830640701*^9}, {
  3.566649707853721*^9, 
  3.566649708070501*^9}},ExpressionUUID->"aa6f1d83-7fe9-4faf-b37b-\
3a73de899bec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PertStateSubs", "[", 
   RowBox[{"X_", ",", "dX_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "+", 
         RowBox[{"dX", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "3"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"QuatInc", "[", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}], "]"}], 
             "]"}], ",", 
            RowBox[{"dX", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"4", ",", "5", ",", "6"}], "}"}], "]"}], "]"}]}], 
           "]"}], ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], "}"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.571130663264105*^9, 3.571130765329321*^9}, {
   3.57113111793888*^9, 3.57113116341093*^9}, {3.571131195958424*^9, 
   3.571131254626845*^9}, 
   3.571133049520565*^9},ExpressionUUID->"9536deeb-c92c-4d88-beef-\
34b38c5843ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"L2", "[", "x_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VecNorm", "[", "x_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "/", 
      RowBox[{"L2", "[", "x", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.568453075302482*^9, 
  3.568453143924776*^9}},ExpressionUUID->"f79041bf-ec20-489b-89e3-\
d37d1d129344"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SkewMatrix", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"0", "Matrix3D"}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", "0", ",", 
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"v", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", "0"}], "}"}]}], "}"}], "/", 
    "2"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.568443187261707*^9, 3.568443273520089*^9}, {
   3.568458568630984*^9, 3.568458568967643*^9}, 
   3.595251129863083*^9},ExpressionUUID->"b5746471-5a29-4d7b-ba87-\
a9caf25de7d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConstantAngularSpeedTMatrix", "[", 
    RowBox[{"w_", ",", "dt_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"L2", "[", "w", "]"}], 
       RowBox[{"dt", "/", "2"}]}], "]"}], " ", 
     RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "+", 
    RowBox[{"2", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"L2", "[", "w", "]"}], 
        RowBox[{"dt", "/", "2"}]}], "]"}], "/", 
      RowBox[{"L2", "[", "w", "]"}]}], " ", 
     RowBox[{"SkewMatrix", "[", "w", "]"}]}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5684429732904*^9, 3.56844300516892*^9}, {
  3.568443103374373*^9, 3.568443183239631*^9}, {3.56844338461282*^9, 
  3.568443409373211*^9}, {3.568453008511107*^9, 
  3.568453014783046*^9}},ExpressionUUID->"6ece512f-3f0a-46c3-89ae-\
66a32927e121"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SubVec", "[", 
    RowBox[{"exp_", ",", "v1_", ",", "v2_"}], "]"}], ":=", 
   RowBox[{"exp", "/.", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v1", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
       RowBox[{"v2", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"v1", ",", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VecToZero", "[", 
    RowBox[{"exp_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"exp", "/.", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"v", ",", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.568444740747602*^9, 3.568444776506934*^9}, {
  3.568444838483142*^9, 
  3.568444844345901*^9}},ExpressionUUID->"3f6fea1a-96bd-4814-be71-\
fbd023dc58a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToGoodC", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "oexp", "}"}], ",", " ", 
    RowBox[{
     RowBox[{"oexp", "=", 
      RowBox[{"Experimental`OptimizeExpression", "[", "exp", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", " ", "[", 
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"InputForm", "[", "oexp", "]"}], "]"}], ",", 
             "\"\<Compile\>\""}], "]"}], ",", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"locals", ",", " ", "code"}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"locals", ",", "code"}], "}"}], "=", 
           RowBox[{"ReleaseHold", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Hold", "@@", "oexp"}], ")"}], "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"Verbatim", "[", "Block", "]"}], "[", 
               RowBox[{"vars_", ",", "seq_"}], "]"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"vars", ",", 
                RowBox[{"Hold", "[", "seq", "]"}]}], "}"}]}]}], "]"}]}], ";", 
          
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "code", "]"}], "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", ",", " ", 
       RowBox[{"ToString", "[", 
        RowBox[{"CForm", "[", "exp", "]"}], "]"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyStringWrite", "[", 
   RowBox[{"str_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "stream", "}"}], ",", 
    RowBox[{
     RowBox[{"stream", "=", 
      RowBox[{"OpenWrite", "[", "file", "]"}]}], ";", 
     RowBox[{"WriteString", "[", 
      RowBox[{"stream", ",", "str"}], "]"}], ";", 
     RowBox[{"Close", "[", "stream", "]"}], ";"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.568440350374321*^9, {3.56844481385726*^9, 3.56844481884285*^9}, {
   3.568446816971497*^9, 3.568446831371454*^9}, {3.56844689667688*^9, 
   3.568446897039928*^9}, {3.571133081827365*^9, 
   3.571133085326789*^9}},ExpressionUUID->"8f2a1ffc-716f-4de3-b38a-\
4aa90447974d"],

Cell[CellGroupData[{

Cell["State", "Subsubtitle",
 CellChangeTimes->{{3.5732982476551723`*^9, 
  3.573298257964068*^9}},ExpressionUUID->"b4b0dbf5-8125-4b4d-978f-\
9d4ebf719f7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"x", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "19"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5732982634483347`*^9, 
  3.573298275094433*^9}},ExpressionUUID->"fd967818-52ec-44bf-b6c2-\
2f3bba0ab878"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"POSE", "=", 
   RowBox[{"X", "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"X", "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"X", "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{"8", ",", "9", ",", "10"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"X", "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{"11", ",", "12", ",", "13"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"X", "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{"14", ",", "15", ",", "16"}], "}"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Alpha", "=", 
   RowBox[{"X", "[", 
    RowBox[{"[", 
     RowBox[{"{", 
      RowBox[{"17", ",", "18", ",", "19"}], "}"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.573298284919364*^9, 
  3.573298372143531*^9}},ExpressionUUID->"9af349d4-9232-4948-b13e-\
c0c0f33bd277"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"z", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.573298395591227*^9, 3.5732984059854527`*^9}, {
  3.573986298802697*^9, 3.5739862988715477`*^9}, {3.5763018686743193`*^9, 
  3.5763018687993317`*^9}},ExpressionUUID->"c5aaee0a-c995-4d8a-9c12-\
020b7cb694e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NOISES", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"eta", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5732984077193327`*^9, 3.5732984190733643`*^9}, {
  3.5732985094872217`*^9, 3.573298510909724*^9}, {3.573986294795455*^9, 
  3.5739862948647423`*^9}, {3.576301872092723*^9, 
  3.576301872407092*^9}},ExpressionUUID->"b04ced1c-71c9-498a-98fc-\
03f876c4d9a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameteres", "Subsubtitle",
 CellChangeTimes->{{3.576301900242988*^9, 
  3.576301906388761*^9}},ExpressionUUID->"5b87d06e-fae0-4bf1-9f00-\
e633c10b086b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "[", "1", "]"}], ",", " ", 
       RowBox[{"r", "[", "2", "]"}], ",", " ", 
       RowBox[{"r", "[", "3", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "[", "4", "]"}], ",", 
       RowBox[{"r", "[", "5", "]"}], ",", " ", 
       RowBox[{"r", "[", "6", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "[", "7", "]"}], ",", " ", 
       RowBox[{"r", "[", "8", "]"}], ",", " ", 
       RowBox[{"r", "[", "9", "]"}]}], "}"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s", "[", "1", "]"}], ",", " ", 
     RowBox[{"s", "[", "2", "]"}], ",", " ", 
     RowBox[{"s", "[", "3", "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"H", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"h", "[", "i", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.576301913194021*^9, 
  3.5763019651630497`*^9}},ExpressionUUID->"c69cfecb-a32a-46eb-9995-\
6c21dae365a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations", "Subsubtitle",
 CellChangeTimes->{{3.573298514193714*^9, 
  3.5732985158016453`*^9}},ExpressionUUID->"63a20178-6e98-4a17-bce4-\
f4484f1e551c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ERR", "=", 
   RowBox[{
    RowBox[{"R", ".", 
     RowBox[{"QuatToRot", "[", 
      RowBox[{"QuatInv", "[", "Q", "]"}], "]"}], ".", "H"}], "+", "S", "+", 
    "NOISES", "-", "Z"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.576301983871264*^9, 3.576301984155916*^9}, {
  3.576302063619853*^9, 3.5763020959975243`*^9}, {3.576302186519122*^9, 
  3.576302188132945*^9}, {3.576303323463335*^9, 3.576303353755279*^9}, {
  3.576579048285276*^9, 3.576579079402192*^9}, {3.595251982018874*^9, 
  3.5952520136006517`*^9}},ExpressionUUID->"dc80b13e-e36a-4a02-b755-\
95c76fc28a1e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"eta", "[", "1", "]"}], "+", 
        RowBox[{"s", "[", "1", "]"}], "+", 
        RowBox[{
         RowBox[{"h", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"r", "[", "1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", "4", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"x", "[", "5", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "6", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "7", "]"}], "2"]}], ")"}]}]}], ")"}]}], "+", 
        
        RowBox[{
         RowBox[{"h", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"x", "[", "4", "]"}]}], " ", 
               RowBox[{"x", "[", "5", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "6", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"r", "[", "2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", "4", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "5", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"x", "[", "6", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "7", "]"}], "2"]}], ")"}]}]}], ")"}]}], "+", 
        
        RowBox[{
         RowBox[{"h", "[", "3", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"x", "[", "4", "]"}]}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "2", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "5", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "6", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"r", "[", "3", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", "4", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "5", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "6", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"x", "[", "7", "]"}], "2"]}], ")"}]}]}], ")"}]}], "-", 
        
        RowBox[{"z", "[", "1", "]"}]}]},
      {
       RowBox[{
        RowBox[{"eta", "[", "2", "]"}], "+", 
        RowBox[{"s", "[", "2", "]"}], "+", 
        RowBox[{
         RowBox[{"h", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "5", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"r", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", "4", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"x", "[", "5", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "6", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "7", "]"}], "2"]}], ")"}]}]}], ")"}]}], "+", 
        
        RowBox[{
         RowBox[{"h", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"x", "[", "4", "]"}]}], " ", 
               RowBox[{"x", "[", "5", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "6", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"r", "[", "5", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", "4", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "5", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"x", "[", "6", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "7", "]"}], "2"]}], ")"}]}]}], ")"}]}], "+", 
        
        RowBox[{
         RowBox[{"h", "[", "3", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "4", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"x", "[", "4", "]"}]}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "5", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "5", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "6", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"r", "[", "6", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", "4", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "5", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "6", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"x", "[", "7", "]"}], "2"]}], ")"}]}]}], ")"}]}], "-", 
        
        RowBox[{"z", "[", "2", "]"}]}]},
      {
       RowBox[{
        RowBox[{"eta", "[", "3", "]"}], "+", 
        RowBox[{"s", "[", "3", "]"}], "+", 
        RowBox[{
         RowBox[{"h", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "9", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"r", "[", "7", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", "4", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"x", "[", "5", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "6", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "7", "]"}], "2"]}], ")"}]}]}], ")"}]}], "+", 
        
        RowBox[{
         RowBox[{"h", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "7", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "9", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"x", "[", "4", "]"}]}], " ", 
               RowBox[{"x", "[", "5", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "6", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"r", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", "4", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "5", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"x", "[", "6", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "7", "]"}], "2"]}], ")"}]}]}], ")"}]}], "+", 
        
        RowBox[{
         RowBox[{"h", "[", "3", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "7", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"x", "[", "4", "]"}]}], " ", 
               RowBox[{"x", "[", "6", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "5", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"r", "[", "8", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "4", "]"}], " ", 
               RowBox[{"x", "[", "5", "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "6", "]"}], " ", 
               RowBox[{"x", "[", "7", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"r", "[", "9", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", "4", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "5", "]"}], "2"], "-", 
              SuperscriptBox[
               RowBox[{"x", "[", "6", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"x", "[", "7", "]"}], "2"]}], ")"}]}]}], ")"}]}], "-", 
        
        RowBox[{"z", "[", "3", "]"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.595251985422988*^9, 
  3.595252011173177*^9}},ExpressionUUID->"fd9566e3-0d44-4256-919c-\
d4eb3c157544"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Output", "Subsubtitle",
 CellChangeTimes->{{3.573298851623851*^9, 
  3.57329885458322*^9}},ExpressionUUID->"e5f0a04c-18ec-493f-885e-\
d0a9dd9347bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",ExpressionU\
UID->"c3844903-cd88-484a-979c-b6669fa4eca9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Err", " ", "=", " ", 
   RowBox[{"VecToZero", "[", 
    RowBox[{"ERR", ",", "NOISES"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JErrNoises", "=", 
   RowBox[{"VecToZero", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"ERR", ",", 
       RowBox[{"{", "NOISES", "}"}]}], "]"}], ",", "NOISES"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JErrQ", "=", 
   RowBox[{"VecToZero", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"ERR", ",", 
       RowBox[{"{", "Q", "}"}]}], "]"}], ",", "NOISES"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JErrR", " ", "=", 
   RowBox[{"VecToZero", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"ERR", ",", 
       RowBox[{"{", 
        RowBox[{"Flatten", "[", "R", "]"}], "}"}]}], "]"}], ",", "NOISES"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JErrS", " ", "=", 
   RowBox[{"VecToZero", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"ERR", ",", 
       RowBox[{"{", "S", "}"}]}], "]"}], ",", "NOISES"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JErrH", " ", "=", 
   RowBox[{"VecToZero", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"ERR", ",", 
       RowBox[{"{", "H", "}"}]}], "]"}], ",", "NOISES"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.573299033702265*^9, 3.5732990981024723`*^9}, {
   3.573299164795454*^9, 3.5732991692508307`*^9}, {3.573456001706543*^9, 
   3.5734560048187523`*^9}, {3.573986694793659*^9, 3.573986709832223*^9}, {
   3.5763011364473743`*^9, 3.576301144715021*^9}, {3.576302135602254*^9, 
   3.576302138350954*^9}, {3.57630219591964*^9, 3.576302210963977*^9}, {
   3.576302356743224*^9, 3.576302358392372*^9}, {3.576302680775877*^9, 
   3.576302691934931*^9}, {3.5763027309434958`*^9, 3.576302802403173*^9}, {
   3.576303041652462*^9, 3.57630304201124*^9}, {3.576303363220492*^9, 
   3.5763033689194593`*^9}, 3.576306418310133*^9, {3.576579098831478*^9, 
   3.57657910387113*^9}, {3.759751232662174*^9, 
   3.759751236901301*^9}},ExpressionUUID->"ca6c5ffe-8ab1-414a-9bba-\
2c4651f7734e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MyStringWrite", "[", 
   RowBox[{
    RowBox[{"ToGoodC", "[", "Err", "]"}], ",", 
    "\"\<VectorField_Err.mthout\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyStringWrite", "[", 
   RowBox[{
    RowBox[{"ToGoodC", "[", "JErrNoises", "]"}], ",", 
    "\"\<VectorField_JErrNoises.mthout\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyStringWrite", "[", 
   RowBox[{
    RowBox[{"ToGoodC", "[", "JErrQ", "]"}], ",", 
    "\"\<VectorField_JErrQ.mthout\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyStringWrite", "[", 
   RowBox[{
    RowBox[{"ToGoodC", "[", "JErrR", "]"}], ",", 
    "\"\<VectorField_JErrR.mthout\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyStringWrite", "[", 
   RowBox[{
    RowBox[{"ToGoodC", "[", "JErrS", "]"}], ",", 
    "\"\<VectorField_JErrS.mthout\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyStringWrite", "[", 
   RowBox[{
    RowBox[{"ToGoodC", "[", "JErrH", "]"}], ",", 
    "\"\<VectorField_JErrH.mthout\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.57329895973281*^9, 3.5732990549001513`*^9}, {
  3.57329915658729*^9, 3.5732991792126017`*^9}, {3.57329950483379*^9, 
  3.573299506552189*^9}, {3.573456025938487*^9, 3.573456050810623*^9}, {
  3.573986506538691*^9, 3.573986510813534*^9}, {3.573986716836688*^9, 
  3.5739867249163027`*^9}, {3.5763011296951723`*^9, 3.576301132318984*^9}, {
  3.57630214167354*^9, 3.5763021630898314`*^9}, {3.576303034073209*^9, 
  3.57630303893141*^9}, {3.576303071767115*^9, 3.57630308880243*^9}, {
  3.759751313026346*^9, 
  3.759751318114986*^9}},ExpressionUUID->"f65fc6b9-9b4d-4d96-92e3-\
6f0ba9028215"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Run", "[", 
   "\"\<python ../fixMathematicaOutput_v2.py VectorField_Err.mthout err 0 0\>\
\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Run", "[", 
   "\"\<python ../fixMathematicaOutput_v2.py VectorField_JErrNoises.mthout J \
0 0\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Run", "[", 
   "\"\<python ../fixMathematicaOutput_v2.py VectorField_JErrQ.mthout J 0 0\>\
\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Run", "[", 
   "\"\<python ../fixMathematicaOutput_v2.py VectorField_JErrR.mthout J 0 0\>\
\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Run", "[", 
   "\"\<python ../fixMathematicaOutput_v2.py VectorField_JErrS.mthout J 0 0\>\
\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Run", "[", 
   "\"\<python ../fixMathematicaOutput_v2.py VectorField_JErrH.mthout J 0 0\>\
\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5732988905902853`*^9, 3.5732988936108313`*^9}, {
  3.573299192140649*^9, 3.573299200591135*^9}, {3.573299495929981*^9, 
  3.573299519080715*^9}, {3.573299798312479*^9, 3.5732997984226513`*^9}, {
  3.573456031155251*^9, 3.5734560323903913`*^9}, {3.573986512058936*^9, 
  3.573986513635149*^9}, {3.573986728195684*^9, 3.573986731564784*^9}, {
  3.576302165893627*^9, 3.576302171097796*^9}, {3.5763030929686823`*^9, 
  3.5763030962907476`*^9}, {3.759751321209983*^9, 
  3.7597513249989223`*^9}},ExpressionUUID->"506dbe27-a3c4-45b6-b5e5-\
92d112626cf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Run", "[", 
   "\"\<mv *.cppready ../../../roamfree/ROAMfunctions/generated\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6050014532183523`*^9, 3.6050015701885967`*^9}, {
   3.605001619532137*^9, 3.6050016309343433`*^9}, {3.626084473225601*^9, 
   3.626084492513814*^9}, {3.6260847134763527`*^9, 3.6260847142374268`*^9}, 
   3.6345388398230553`*^9},ExpressionUUID->"a1d94274-5513-4b6d-9628-\
57d2d7b4f761"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Run", "[", "\"\<rm *.cppready\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<rm *.mthout\>\"", "]"}], ";"}]}], "Input",Expressio\
nUUID->"52d46cfd-8c9a-4935-af74-bd8ee535f5e9"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{1680, 983},
WindowMargins->{{0, Automatic}, {Automatic, 37}},
FrontEndVersion->"11.1 for Linux x86 (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 228, 5, 54, "Input", "ExpressionUUID" -> \
"d2ae0e34-0aee-4398-84a7-83fdb362b1c0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[798, 29, 242, 5, 53, "Subtitle", "ExpressionUUID" -> \
"a36a670e-ae9b-49f1-b10c-dbccef0a632e",
 InitializationCell->True],
Cell[1043, 36, 4394, 134, 75, "Input", "ExpressionUUID" -> \
"3b9fbfee-912a-4aa4-a2f2-7c73891f3bc4",
 InitializationCell->True],
Cell[5440, 172, 2954, 94, 75, "Input", "ExpressionUUID" -> \
"7da7a48b-0a5f-4ec4-a1d3-d9a2d8334180",
 InitializationCell->True],
Cell[8397, 268, 1816, 56, 51, "Input", "ExpressionUUID" -> \
"c27111b3-50a3-4eb0-bd3f-367c5ebdb657",
 InitializationCell->True],
Cell[10216, 326, 739, 21, 51, "Input", "ExpressionUUID" -> \
"8ff927d0-78c6-4922-9aa0-571bb554bdf5",
 InitializationCell->True],
Cell[10958, 349, 942, 30, 51, "Input", "ExpressionUUID" -> \
"f2b631c2-1610-446a-ad5b-c94cdb78364d",
 InitializationCell->True],
Cell[11903, 381, 1573, 48, 75, "Input", "ExpressionUUID" -> \
"aa6f1d83-7fe9-4faf-b37b-3a73de899bec",
 InitializationCell->True],
Cell[13479, 431, 1636, 48, 51, "Input", "ExpressionUUID" -> \
"9536deeb-c92c-4d88-beef-34b38c5843ce",
 InitializationCell->True],
Cell[15118, 481, 925, 30, 75, "Input", "ExpressionUUID" -> \
"f79041bf-ec20-489b-89e3-d37d1d129344",
 InitializationCell->True],
Cell[16046, 513, 1688, 51, 51, "Input", "ExpressionUUID" -> \
"b5746471-5a29-4d7b-ba87-a9caf25de7d1",
 InitializationCell->True],
Cell[17737, 566, 906, 25, 51, "Input", "ExpressionUUID" -> \
"6ece512f-3f0a-46c3-89ae-66a32927e121",
 InitializationCell->True],
Cell[18646, 593, 1326, 41, 75, "Input", "ExpressionUUID" -> \
"3f6fea1a-96bd-4814-be71-fbd023dc58a3",
 InitializationCell->True],
Cell[19975, 636, 2492, 66, 180, "Input", "ExpressionUUID" -> \
"8f2a1ffc-716f-4de3-b38a-4aa90447974d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[22492, 706, 156, 3, 31, "Subsubtitle", "ExpressionUUID" -> \
"b4b0dbf5-8125-4b4d-978f-9d4ebf719f7d"],
Cell[22651, 711, 348, 10, 35, "Input", "ExpressionUUID" -> \
"fd967818-52ec-44bf-b6c2-2f3bba0ab878"],
Cell[23002, 723, 1282, 45, 155, "Input", "ExpressionUUID" -> \
"9af349d4-9232-4948-b13e-c0c0f33bd277"],
Cell[24287, 770, 448, 11, 35, "Input", "ExpressionUUID" -> \
"c5aaee0a-c995-4d8a-9c12-020b7cb694e3"],
Cell[24738, 783, 504, 12, 35, "Input", "ExpressionUUID" -> \
"b04ced1c-71c9-498a-98fc-03f876c4d9a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25279, 800, 160, 3, 31, "Subsubtitle", "ExpressionUUID" -> \
"5b87d06e-fae0-4bf1-9f00-e633c10b086b"],
Cell[25442, 805, 1241, 37, 83, "Input", "ExpressionUUID" -> \
"c69cfecb-a32a-46eb-9995-6c21dae365a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26720, 847, 160, 3, 31, "Subsubtitle", "ExpressionUUID" -> \
"63a20178-6e98-4a17-bce4-f4484f1e551c"],
Cell[CellGroupData[{
Cell[26905, 854, 604, 13, 35, "Input", "ExpressionUUID" -> \
"dc80b13e-e36a-4a02-b755-95c76fc28a1e"],
Cell[27512, 869, 13813, 374, 93, "Output", "ExpressionUUID" -> \
"fd9566e3-0d44-4256-919c-d4eb3c157544"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41374, 1249, 154, 3, 31, "Subsubtitle", "ExpressionUUID" -> \
"e5f0a04c-18ec-493f-885e-d0a9dd9347bd"],
Cell[41531, 1254, 180, 4, 35, "Input", "ExpressionUUID" -> \
"c3844903-cd88-484a-979c-b6669fa4eca9"],
Cell[41714, 1260, 2159, 57, 155, "Input", "ExpressionUUID" -> \
"ca6c5ffe-8ab1-414a-9bba-2c4651f7734e"],
Cell[43876, 1319, 1731, 41, 155, "Input", "ExpressionUUID" -> \
"f65fc6b9-9b4d-4d96-92e3-6f0ba9028215"],
Cell[45610, 1362, 1526, 39, 155, "Input", "ExpressionUUID" -> \
"506dbe27-a3c4-45b6-b5e5-92d112626cf7"],
Cell[47139, 1403, 453, 10, 35, "Input", "ExpressionUUID" -> \
"a1d94274-5513-4b6d-9628-57d2d7b4f761"],
Cell[47595, 1415, 249, 6, 59, "Input", "ExpressionUUID" -> \
"52d46cfd-8c9a-4935-af74-bd8ee535f5e9"]
}, Open  ]]
}, Open  ]]
}
]
*)

