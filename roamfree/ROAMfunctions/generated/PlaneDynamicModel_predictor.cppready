double tmp0 = x(5+_OFF);
double tmp1 = x(6+_OFF);
double tmp2 = x(4+_OFF);
double tmp3 = x(7+_OFF);
xhat(1+_OFF) = x(1+_OFF) + dt*(std::pow(tmp2,2) + std::pow(tmp0,2) - std::pow(tmp1,2) - std::pow(tmp3,2));
xhat(2+_OFF) = x(2+_OFF) + 2*dt*(tmp0*tmp1 + tmp2*tmp3);
xhat(3+_OFF) = x(3+_OFF) + 2*dt*(-(tmp2*tmp1) + tmp0*tmp3);
xhat(4+_OFF) = tmp2;
xhat(5+_OFF) = tmp0;
xhat(6+_OFF) = tmp1;
xhat(7+_OFF) = tmp3;
